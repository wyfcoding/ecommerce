syntax = "proto3";

package api.notification.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/wyfcoding/ecommerce/goapi/notification/v1;v1";

// 通知服务，处理系统向用户推送的各类即时通知及状态管理。
service Notification {
  // 发送单条系统通知。
  rpc SendNotification(SendNotificationRequest) returns (SendNotificationResponse);

  // 获取用户的通知历史列表。
  rpc ListNotifications(ListNotificationsRequest) returns (ListNotificationsResponse);

  // 标记特定通知为已读。
  rpc MarkNotificationAsRead(MarkNotificationAsReadRequest) returns (MarkNotificationAsReadResponse);
}

// 通知实体。
message Notification {
  // 唯一 ID。
  uint64 notification_id = 1;
  // 接收人 ID。
  uint64 user_id = 2;
  // 通知分类 (ORDER, PROMO, SYSTEM)。
  string type = 3;
  // 标题。
  string title = 4;
  // 正文。
  string content = 5;
  // 是否已读。
  bool is_read = 6;
  // 生成时间。
  google.protobuf.Timestamp created_at = 7;
}

// 发送请求。
message SendNotificationRequest {
  // 用户 ID。
  uint64 user_id = 1;
  // 类别。
  string type = 2;
  // 标题。
  string title = 3;
  // 正文。
  string content = 4;
}

// 发送响应。
message SendNotificationResponse {
  // 通知 ID。
  uint64 notification_id = 1;
}

// 列表查询请求。
message ListNotificationsRequest {
  // 用户 ID。
  uint64 user_id = 1;
  // 过滤条件：是否含已读。
  bool include_read = 2;
  // 每页数量。
  uint32 page_size = 3;
  // 页码。
  uint32 page_num = 4;
}

// 列表响应。
message ListNotificationsResponse {
  // 通知记录序列。
  repeated Notification notifications = 1;
  // 总记录数。
  uint64 total_count = 2;
}

// 已读标记请求。
message MarkNotificationAsReadRequest {
  // 通知 ID。
  uint64 notification_id = 1;
  // 权限校验 ID。
  uint64 user_id = 2;
}

// 已读标记响应。
message MarkNotificationAsReadResponse {}
