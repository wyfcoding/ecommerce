syntax = "proto3";

package api.pointsmall.v1;

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

option go_package = "github.com/wyfcoding/ecommerce/go-api/pointsmall/v1;pointsmallv1";

// PointsmallService Pointsmall服务服务定义。
service PointsmallService {
// CreateProduct 创建商品。
  rpc CreateProduct(CreateProductRequest) returns (CreateProductResponse);
// ListProducts 处理列出Products请求。
  rpc ListProducts(ListProductsRequest) returns (ListProductsResponse);

// ExchangeProduct Exchange商品接口。
  rpc ExchangeProduct(ExchangeProductRequest) returns (ExchangeProductResponse);
// ListOrders 处理列出Orders请求。
  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse);

// GetAccount 获取账户。
  rpc GetAccount(GetAccountRequest) returns (GetAccountResponse);
// AddPoints 处理AddPoints请求。
  rpc AddPoints(AddPointsRequest) returns (google.protobuf.Empty);
}

// PointsProduct Points产品消息结构。
message PointsProduct {
  uint64 id = 1; // 唯一标识
  string name = 2; // 名称
  string description = 3; // 描述
  string image_url = 4; // 图片链接
  int64 points = 5; // 积分
  int32 stock = 6; // 库存
  int32 sold_count = 7; // sold计数
  int32 limit_per_user = 8; // 限制per用户
  int32 status = 9; // 状态
  google.protobuf.Timestamp created_at = 10; // 创建时间
  google.protobuf.Timestamp updated_at = 11; // 更新时间
}

// PointsOrder Points订单消息结构。
message PointsOrder {
  uint64 id = 1; // 唯一标识
  string order_no = 2; // 订单no
  uint64 user_id = 3; // 用户唯一标识
  uint64 product_id = 4; // 产品id
  string product_name = 5; // 产品名称
  int32 quantity = 6; // 数量
  int64 points = 7; // 积分
  int64 total_points = 8; // 总数points
  int32 status = 9; // 状态
  string address = 10; // 地址
  string phone = 11; // 电话
  string receiver = 12; // 收件人
  google.protobuf.Timestamp shipped_at = 13; // shipped在
  google.protobuf.Timestamp completed_at = 14; // completed在
  google.protobuf.Timestamp created_at = 15; // 创建时间
  google.protobuf.Timestamp updated_at = 16; // 更新时间
}

// PointsAccount Points账户消息结构。
message PointsAccount {
  uint64 id = 1; // 唯一标识
  uint64 user_id = 2; // 用户唯一标识
  int64 total_points = 3; // 总数points
  int64 used_points = 4; // 用points
  google.protobuf.Timestamp created_at = 5; // 创建时间
  google.protobuf.Timestamp updated_at = 6; // 更新时间
}

// CreateProductRequest 创建产品请求消息结构。
message CreateProductRequest {
  string name = 1; // 名称
  string description = 2; // 描述
  string image_url = 3; // 图片链接
  int64 points = 4; // 积分
  int32 stock = 5; // 库存
  int32 limit_per_user = 6; // 限制per用户
  int32 status = 7; // 状态
}

// CreateProductResponse 创建产品响应消息结构。
message CreateProductResponse {
  PointsProduct product = 1; // 产品
}

// ListProductsRequest 列出Products请求消息结构。
message ListProductsRequest {
  int32 status = 1; // 状态
  int32 page = 2; // 页码
  int32 page_size = 3; // 页码大小
}

// ListProductsResponse 列出Products响应消息结构。
message ListProductsResponse {
  repeated PointsProduct products = 1; // 商品列表
  int64 total_count = 2; // 总数计数
}

// ExchangeProductRequest Exchange产品请求消息结构。
message ExchangeProductRequest {
  uint64 user_id = 1; // 用户唯一标识
  uint64 product_id = 2; // 产品id
  int32 quantity = 3; // 数量
  string address = 4; // 地址
  string phone = 5; // 电话
  string receiver = 6; // 收件人
}

// ExchangeProductResponse Exchange产品响应消息结构。
message ExchangeProductResponse {
  PointsOrder order = 1; // 订单
}

// ListOrdersRequest 列出Orders请求消息结构。
message ListOrdersRequest {
  uint64 user_id = 1; // 用户唯一标识
  int32 status = 2; // 状态
  int32 page = 3; // 页码
  int32 page_size = 4; // 页码大小
}

// ListOrdersResponse 列出Orders响应消息结构。
message ListOrdersResponse {
  repeated PointsOrder orders = 1; // 订单列表
  int64 total_count = 2; // 总数计数
}

// GetAccountRequest 获取账户请求消息结构。
message GetAccountRequest {
  uint64 user_id = 1; // 用户唯一标识
}

// GetAccountResponse 获取账户响应消息结构。
message GetAccountResponse {
  PointsAccount account = 1; // 账户
}

// AddPointsRequest AddPoints请求消息结构。
message AddPointsRequest {
  uint64 user_id = 1; // 用户唯一标识
  int64 points = 2; // 积分
  string description = 3; // 描述
  string ref_id = 4; // ref唯一标识
}
