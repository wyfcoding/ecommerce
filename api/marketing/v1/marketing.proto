syntax = "proto3";

package api.marketing.v1;

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

option go_package = "github.com/wyfcoding/ecommerce/go-api/marketing/v1;marketingv1";

service MarketingService {
  // Campaign Management
  rpc CreateCampaign(CreateCampaignRequest) returns (CreateCampaignResponse);
  rpc GetCampaign(GetCampaignRequest) returns (GetCampaignResponse);
  rpc UpdateCampaignStatus(UpdateCampaignStatusRequest) returns (google.protobuf.Empty);
  rpc ListCampaigns(ListCampaignsRequest) returns (ListCampaignsResponse);
  rpc RecordParticipation(RecordParticipationRequest) returns (google.protobuf.Empty);

  // Banner Management
  rpc CreateBanner(CreateBannerRequest) returns (CreateBannerResponse);
  rpc ListBanners(ListBannersRequest) returns (ListBannersResponse);
  rpc DeleteBanner(DeleteBannerRequest) returns (google.protobuf.Empty);
  rpc ClickBanner(ClickBannerRequest) returns (google.protobuf.Empty);
}

message Campaign {
  uint64 id = 1;
  string name = 2;
  string campaign_type = 3;
  string description = 4;
  google.protobuf.Timestamp start_time = 5;
  google.protobuf.Timestamp end_time = 6;
  uint64 budget = 7;
  uint64 spent = 8;
  int64 target_users = 9;
  int64 reached_users = 10;
  int32 status = 11;
  string rules_json = 12; // 规则的 JSON 字符串
  google.protobuf.Timestamp created_at = 13;
  google.protobuf.Timestamp updated_at = 14;
}

message Banner {
  uint64 id = 1;
  string title = 2;
  string image_url = 3;
  string link_url = 4;
  string position = 5;
  int32 priority = 6;
  google.protobuf.Timestamp start_time = 7;
  google.protobuf.Timestamp end_time = 8;
  int64 click_count = 9;
  bool enabled = 10;
  google.protobuf.Timestamp created_at = 11;
  google.protobuf.Timestamp updated_at = 12;
}

message CreateCampaignRequest {
  string name = 1;
  string campaign_type = 2;
  string description = 3;
  google.protobuf.Timestamp start_time = 4;
  google.protobuf.Timestamp end_time = 5;
  uint64 budget = 6;
  string rules_json = 7;
}

message CreateCampaignResponse {
  Campaign campaign = 1;
}

message GetCampaignRequest {
  uint64 id = 1;
}

message GetCampaignResponse {
  Campaign campaign = 1;
}

message UpdateCampaignStatusRequest {
  uint64 id = 1;
  int32 status = 2;
}

message ListCampaignsRequest {
  int32 status = 1;
  int32 page = 2;
  int32 page_size = 3;
}

message ListCampaignsResponse {
  repeated Campaign campaigns = 1;
  int64 total_count = 2;
}

message RecordParticipationRequest {
  uint64 campaign_id = 1;
  uint64 user_id = 2;
  uint64 order_id = 3;
  uint64 discount = 4;
}

message CreateBannerRequest {
  string title = 1;
  string image_url = 2;
  string link_url = 3;
  string position = 4;
  int32 priority = 5;
  google.protobuf.Timestamp start_time = 6;
  google.protobuf.Timestamp end_time = 7;
}

message CreateBannerResponse {
  Banner banner = 1;
}

message ListBannersRequest {
  string position = 1;
  bool active_only = 2;
}

message ListBannersResponse {
  repeated Banner banners = 1;
}

message DeleteBannerRequest {
  uint64 id = 1;
}

message ClickBannerRequest {
  uint64 id = 1;
}