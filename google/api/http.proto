// Copyright 2016 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package google.api;

option go_package = "google.golang.org/genproto/googleapis/api/annotations;annotations";
option java_multiple_files = true;
option java_outer_classname = "HttpProto";
option java_package = "com.google.api";
option objc_class_prefix = "GAPI";

// Defines the HTTP configuration for an API service. It contains a list of
// `HttpRule`, each specifying the mapping of an RPC method
// to one or more HTTP REST API methods.
message Http {
  // A list of HTTP configuration rules that apply to individual API methods.
  //
  // **NOTE:** All service configuration rules follow "last one wins" order.
  repeated HttpRule rules = 1;
}

// `HttpRule` defines the mapping of an RPC method to one or more HTTP
// REST API methods. The mapping specifies how different portions of the RPC
// request message are mapped to URL path, URL query parameters, and
// HTTP request body. The mapping is typically specified as an
// `google.api.http` annotation on the RPC method.
//
// Each rule maps a URL pattern to a method. The URL pattern may have a
// special syntax corresponding to bindings from URL path parts to RPC request
// fields. For more details, see `google/api/http.proto`.
message HttpRule {
  // Selects a method to which this rule applies. Refer to `selector` for syntax details.
  string selector = 1;

  // The name of the request field whose value is mapped to the HTTP body.
  // It can be `*` to represent the entire request body. It can be omitted
  // to represent an empty body. If a request field is not bound to the
  // body, it is assumed to be bound to the URL query parameters.
  string body = 7;

  // A list of custom verb definitions.
  repeated CustomHttpPattern additional_bindings = 11;

  // Determines the URL pattern is matched by this rules. This pattern can be
  // used with any of the {get|put|post|delete|patch} methods. A custom method
  // can be defined using the `custom` field.
  oneof pattern {
    // Used for listing and getting information about resources.
    string get = 2;

    // Used for updating a resource.
    string put = 3;

    // Used for creating a resource.
    string post = 4;

    // Used for deleting a resource.
    string delete = 5;

    // Used for updating a resource.
    string patch = 6;

    // The custom pattern is used for specifying custom HTTP verb.
    CustomHttpPattern custom = 8;
  }
}

// A custom pattern is used for defining custom HTTP verbs.
message CustomHttpPattern {
  // The name of this custom HTTP verb.
  string kind = 1;

  // The path template. The syntax is the same as an HTTP path template.
  string path = 2;
}
